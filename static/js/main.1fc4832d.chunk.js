(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{190:function(e,t,a){},193:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),o=a(14),s=a.n(o),c=(a(90),a(21)),l=a(70),u=a.n(l),d=a(10),m=a(8),p=a.n(m),f=a(13),g=a(16),v=a(19),h=a(17),E=a(20),b=a(38),N=a.n(b),w=a(196),O=function(e){var t=e.title,a=e.message;return i.a.createElement("div",{className:"infoBoxWrapper"},i.a.createElement("div",{className:"infoWrapper"},i.a.createElement("h1",{className:"titleText"},t),i.a.createElement("h2",{className:"infoSubText"},a)))},j=function(){return i.a.createElement(O,{title:"LOADING EXPERIENCE",message:"PLEASE WAIT"})},S=function(e,t){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain="+t},y=a(71),C=a.n(y),A=a(48),k=a(37),T=Object(A.a)(Object(A.b)({componentDidMount:function(){"production"===Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV&&k.a.pageview(window.location.pathname)}})),U=a(84),D=a(198),M=a(195),L=a(74),P=a(9),x=a.n(P),_=["driverName","email","phone","rideshareServices","cities"],I=["description"],R={driverName:"Your Full Name:",email:"Your Email Address:",password:"Your Password:",phone:"Your Phone Number:",rideshareServices:"Your Rideshare Services:",cities:"Cities You Drive In:",description:"A Message To Riders:",languages:"Languages:"},B={driverName:"First Last",email:"johndoe@domain.com",password:"8 or more characters, 1 or more: capitals, lowercase, numbers, special characters",phone:"### ### ####",rideshareServices:"eg. Uber, Lyft (Comma Seperated)",cities:"eg. Toronto, Detroit (Comma Seperated)",description:"A nice message to your riders",languages:"eg. English, French (Comma Seperated)"},Y={driverName:"Name should include First and Last, eg. 'John Doe'",email:"The email you signed up with is not a valid email address",password:"Password has at least 1 capital, lowercase, number, and special character, and is at least 8 characters long",phone:"Phone number should be 10 digits eg. '(555) 123-4567'",rideshareServices:"Rideshare Services should be comma seperated list eg. 'Uber, Lyft'",cities:"Cities should be valid cities in comma seperated list eg. 'Toronto, Detroit'",description:"Message to riders should be valid ASCII text",languages:"Make sure languages are a comma seperated list"},Z=function(e){return _.every(function(t){return e[t]})},F=function(e,t){if("string"===typeof t)return t;switch(e){case"driverName":return Object.values(t).reverse().join(" ");case"cities":case"rideshareServices":case"tabletIds":case"languages":return t.join(", ");default:return t}},G=function(e,t){var a="";if(!t)return!1;switch(a="password"===e?t:x.a.trim(t+""),e){case"driverName":if(!a)return;var n=a.split(" ").map(function(e){return x.a.matches(x.a.trim(e),/^[a-zA-Z-]+$/i)?x.a.trim(e):void 0}).filter(function(e){return e});return n.length>1?{first:n[0],last:n.slice(1).join(" ")}:void 0;case"email":return x.a.isEmail(a)?x.a.normalizeEmail(a):void 0;case"password":return x.a.matches(a,/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-.]).{8,}$/)?a:void 0;case"phone":var r=(""+a).replace(/\D/g,"").match(/^(\d|)?(\d{3})(\d{3})(\d{4})$/);return r?[r[1]?"+"+r[1]+" ":"","(",r[2],") ",r[3],"-",r[4]].join(""):void 0;case"cities":var i=a.split(",").map(function(e){return x.a.matches(x.a.trim(e),/^[a-zA-Z- ]+$/i)?x.a.trim(e):void 0}).filter(function(e){return e});return i.length>0?i:void 0;case"rideshareServices":var o=a.split(",").map(function(e){return x.a.matches(x.a.trim(e),/^[\w\- ]+$/i)?x.a.trim(e):void 0}).filter(function(e){return e});return o.length>0?o:void 0;case"description":return x.a.isAscii(a)?x.a.trim(a):void 0;default:return}},W=function(e){var t=Object(U.a)(_);return e.askForPassword&&t.splice(2,0,"password"),i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",{className:"formHeader"},e.isSignUp?"Required Fields:":"About You:"),i.a.createElement("div",{className:"formWrapper"},i.a.createElement(D.a,{className:"formObject"},t.map(function(t,a){return i.a.createElement(D.a.Group,{as:M.a,className:"formGroup",key:a},i.a.createElement(D.a.Label,{className:"formLabel",column:!0,sm:"2"}," ",R[t]," "),i.a.createElement(L.a,{sm:"10"},i.a.createElement(D.a.Control,function(e,t){var a="text",n=e.isSignUp?B[t]:F(t,e.driver[t]);return"email"===t?(a="username",n=e.email):"password"===t&&(a="password"),{className:"formControl",readOnly:"email"===t||e.readOnly,plaintext:"email"===t||e.plaintext,onChange:function(a){return e.handleInput(a,t)},type:a,placeholder:n}}(e,t))))}))))},V=function(e){if(0===I.length)return null;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",{className:"formHeader"},"Addtional Information:"),i.a.createElement("div",{className:"formWrapper"},i.a.createElement(D.a,{className:"formObject"},I.map(function(t,a){return i.a.createElement(D.a.Group,{as:M.a,className:"formGroup",key:a},i.a.createElement(D.a.Label,{className:"formLabel",column:!0,sm:"2"}," ",R[t]," "),i.a.createElement(L.a,{sm:"10"},i.a.createElement(D.a.Control,function(t){return{className:"formControl",readOnly:e.readOnly,plaintext:e.plaintext,onChange:function(a){e.handleInput(a,t)},placeholder:e.driver[t]?e.driverUpdate[t]:"(Optional) "+B[t]}}(t))))}))))},z=a(197),J=a(199),H=function(){window.location.href="https://portlmedia.com/"},q=function(e){return i.a.createElement(z.a,{className:"navbarHeader",collapseOnSelect:!0,expand:"lg",bg:"white",variant:"light"},i.a.createElement("img",{className:"portlLogo",src:"https://portl-client-microsites.s3.amazonaws.com/porttllogo.png",alt:"portl logo",onClick:H}),i.a.createElement(z.a.Text,{className:"navbarText"},i.a.createElement("h1",{className:"headerText"},e.title)),i.a.createElement(z.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),i.a.createElement(z.a.Collapse,{className:"navbarCollapse",id:"responsive-navbar-nav"},i.a.createElement(J.a,null,i.a.createElement(J.a.Link,{href:"/profile#"},"Profile"),i.a.createElement(J.a.Link,{href:"/settings#"},"Settings"),i.a.createElement(J.a.Link,{href:"/leaderboard#"},"Leader Board"),i.a.createElement(J.a.Link,{href:"/about#"},"About"))))},K=T(function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(v.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){a.initDriverUpdate()},a.initDriverUpdate=function(){var e={};_.forEach(function(t){e[t]=a.state.isSignUp?"":F(t,a.state.driver[t])}),I.forEach(function(t){e[t]=a.state.driver[t]?F(t,a.state.driver[t]):""}),console.log("inited driver:",e),a.setState({driverUpdate:e,isLoading:!1})},a.editingButtons=function(){return i.a.createElement("div",{className:"editingButtons"},i.a.createElement(w.a,{className:"submissionButton",onClick:a.handleSubmit}," Save Your Changes "),i.a.createElement(w.a,{className:"submissionButton",onClick:function(){return a.stopEditing(a.changes)}}," Cancel "))},a.notEditingButton=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(w.a,{className:"submissionButton",onClick:a.startEditing}," Edit Your Profile "),i.a.createElement(w.a,{className:"submissionButton",onClick:a.handleDone}," I'm Done Signing Up "))},a.handleSubmit=Object(f.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.state.handleFormSubmission(a.state.driverUpdate,a.state.picture,a.ref);case 2:e.sent&&(a.stopEditing(),a.setState({isSignUp:!1}));case 4:case"end":return e.stop()}},e)})),a.handleDone=function(){a.state.setModal(!0,"Thanks for Signing Up","We will contact you soon, for now we will send you back to our website","Got It, Send Me Back",a.state.redirectToOrigin)},a.handleInput=function(e,t){var n=e.target.value,r=Object(d.a)({},a.state.driverUpdate);r[t]=n,a.changes=!0,a.setState({driverUpdate:r})},a.onDrop=function(e){try{var t=e.length-1;e[t].url=URL.createObjectURL(e[t]),console.log("picture:",e),a.setState({picture:[e[t]?e[t]:void 0]})}catch(n){console.log("Error occurred in handling picture:",n),a.props.setNotification(!0,"Error","An error occurred in handling your image",!0)}},a.startEditing=function(){a.setState({isEditing:!0})},a.stopEditing=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e)a.changes=!1,document.location.reload(),a.stopEditing();else{a.changes=!1;var t=Object(d.a)({},a.state.driverUpdate);a.state.picture.length>0&&(t.profile=a.state.picture[a.state.picture.length-1].url+"#"+(new Date).getTime()),a.setState({driverUpdate:e?a.state.driver:t,isEditing:!1})}},a.render=function(){var e={readOnly:!a.state.isEditing,email:a.state.email,driver:a.state.driver,driverUpdate:a.state.driverUpdate,handleInput:a.handleInput},t={readOnly:!a.state.isEditing,email:a.state.email,driver:Object(d.a)({},a.state.driverUpdate),handleInput:a.handleInput,isSignUp:a.state.isSignUp},n={withIcon:!1,singleImage:!0,buttonText:"Choose a new profile picture",onChange:a.onDrop,imgExtension:[".jpg",".gif",".png",".gif",".jpeg",".bmp"],label:"Max file size: 5mb, Accepts .jpg, .png, .gif",maxFileSize:5e6,className:"imgUploader"},r=a.state.picture.length-1,o=window.innerWidth>325?{width:300}:{width:"75vw"};return a.state.isLoading?i.a.createElement(j,null):i.a.createElement(i.a.Fragment,null,i.a.createElement(q,{title:a.state.isSignUp?"Sign Up":"Your Profile",redirectToOrigin:a.state.redirectToOrigin}),i.a.createElement("div",{className:"profileBackground"},i.a.createElement("img",{id:"target",src:r>=0&&a.state.picture[r]?a.state.picture[r].url:a.state.driver.profile+"#"+(new Date).getTime(),alt:"Your profile",className:"profilePic"}),a.state.isEditing&&i.a.createElement(C.a,Object.assign({},n,{style:o}))),!a.state.isEditing&&a.notEditingButton(),a.state.isEditing&&r>=0&&a.editingButtons(),i.a.createElement(W,t),i.a.createElement(V,e),a.state.isEditing&&a.editingButtons(),!a.state.isEditing&&i.a.createElement(w.a,{className:"submissionButton",onClick:a.state.logoutDriver}," Logout "))},a.state={email:e.email,driver:e.driver,redirectToOrigin:e.redirectToOrigin,logoutDriver:e.logoutDriver,isSignUp:e.isSignUp,isLoading:!0,handleFormSubmission:e.handleFormSubmission,picture:[],setModal:e.setModal,setNotification:e.setNotification,isEditing:!0},a.ref=e.driver.referrer,a.changes=!1,console.log(a.ref),a}return Object(E.a)(t,e),t}(r.Component));console.log("env var:",Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV),n="production"===Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV?"https://api.portlmedia.com":(Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV,"https://api-staging.portlmedia.com");var Q=function(e){window.location.href=e},X=function(e){return i.a.createElement("div",{className:"infoBoxWrapper"},i.a.createElement("div",{className:"infoWrapper"},i.a.createElement("h1",{className:"titleText"}," ",e.title," "),i.a.createElement("h2",{className:"infoSubText"},"string"===typeof e.error?e.error:Object.entries(e.error).join(", ")),i.a.createElement(w.a,{onClick:function(){return Q(n+"/auth0login/wordpress")},className:"submissionButton",type:"submit"},"Sign in"),i.a.createElement(w.a,{onClick:function(){return Q("https://portlmedia.com/contact-us")},className:"submissionButton",type:"submit"},"Back to portlmedia.com")))},$=T(function(e){return console.log(e.err),i.a.createElement(X,{error:e.err,title:"Error"})}),ee=function(e){var t={credentials:"include",method:e};return"GET"===e&&(t.headers={Accept:"application/json","Content-Type":"application/json"}),t},te=function(e,t){console.log("Getting Driver");var a=Object(d.a)({},ee("GET")),r=n+"/driver/info/",i=new Request(r,a);console.log(r),fetch(i).then(e).catch(t)},ae=function(e,t){var a=new FormData;return t&&a.append("ref",t),_.concat(I).forEach(function(t){if(e[t])if(Array.isArray(e[t]))for(var n=0;n<e[t].length;n++)a.append(t+"["+n+"]",e[t][n]);else if("object"===typeof e[t])a.set(t,JSON.stringify(e[t]));else{if("string"!==typeof e[t])return;a.set(t,e[t])}}),a},ne=function(){var e=Object(f.a)(p.a.mark(function e(t,a,r,i){var o,s,c,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Creating driver with ref:",r),o=Object(d.a)({},t),s=ae(o,r),c=Object(d.a)({},ee("POST"),{body:s}),l=n+"/driver/update/",u=new Request(l,c),console.log("creating driver",l,c),fetch(u).then(a).catch(i);case 8:case"end":return e.stop()}},e)}));return function(t,a,n,r){return e.apply(this,arguments)}}(),re=function(e,t,a,r){var i=Object(d.a)({},e),o=ae(i);t&&(o.set("profile",t),o.set("fileType",t.type));var s=Object(d.a)({},ee("POST"),{body:o}),c=n+"/driver/update/",l=new Request(c,s);console.log("updating driver",c,s),fetch(l).then(a).catch(r)};N.a.setAppElement("#root");var ie=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(v.a)(this,Object(h.a)(t).call(this,e))).logoutDriver=Object(f.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:S("token","portlmedia.com"),window.location.href="https://dev-2nvx8dom.auth0.com/v2/logout?returnTo=https%3A%2F%2Fportlmedia.com";case 2:case"end":return e.stop()}},e)})),a.redirectToOrigin=function(){window.location.href="https://portlmedia.com/"},a.setModal=function(e,t,n,r,i){var o=e?Object(d.a)({},a.state.modal):{};o.isOpen=e,t&&(o.title=t),n&&(Array.isArray(n)?o.text=n:o.text=[n]),r&&i&&(o.buttonPrompt=r),i&&(o.onClick=i),a.setState({modal:o})},a.createModal=function(){return i.a.createElement(N.a,{isOpen:a.state.modal.isOpen,onRequestClose:function(){return a.setModal(!1)},shouldFocusAfterRender:!0,className:"alertModal",overlayClassName:"alertModalOverlay"},i.a.createElement("button",{onClick:function(){return a.setModal(!1)},className:"modalCloseButton"},"\xd7"),i.a.createElement("h1",{className:"alertModalTitle"},a.state.modal.title),a.state.modal.text&&a.state.modal.text.map(function(e,t){return i.a.createElement("p",{key:t,className:"alertModalText"},e)}),a.state.modal.buttonPrompt&&i.a.createElement(w.a,{onClick:a.state.modal.onClick,className:"optionalModalButton"},a.state.modal.buttonPrompt))},a.setNotification=function(e,t,n,r){arguments.length>4&&void 0!==arguments[4]&&arguments[4];console.log("opening notification"),a.setState({notification:{isOpen:!1}},function(){var i=e?Object(d.a)({},a.state.notification):{};i.isOpen=e,t&&(i.title=t),n&&(i.text=n),r&&(i.isError=!0),a.setState({notification:i})})},a.createNotification=function(){var e="notificationModal green",t="notificationModalTitle green",n="notificationModalText green",r=String(a.state.notification.text);return r&&"object"===typeof r&&(r=Object.entries(r)),a.state.notification.isError?(e="notificationModal red",t="notificationModalTitle red",n="notificationModalText red",console.log("error notif:",a.state.notification),r||(r="Something went wrong, try again in a few minutes or contact us for further support")):console.log("sucess notif:",a.state.notification),i.a.createElement(N.a,{isOpen:a.state.notification.isOpen,onRequestClose:function(){return a.setNotification(!1)},shouldCloseOnOverlayClick:!1,shouldFocusAfterRender:!1,className:e,overlayClassName:"notificationModalOverlay",onClick:function(){return a.setNotification(!1)}},i.a.createElement("button",{onClick:function(){return a.setNotification(!1)},className:"notificationCloseButton"},"\xd7"),i.a.createElement("h1",{className:t},a.state.notification.title),i.a.createElement("p",{className:n},r))},a.notifyError=function(e){var t=e;t||(t="Something went wrong, try again in a few minutes"),a.setNotification(!0,"An Error Occurred",t,!0),a.setState({isLoading:!1})},a.handleError=function(e){console.log("Error:",e),a.setState({error:e,isLoading:!1})},a.receiveDriver=function(){var e=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("received driver"),e.next=3,t.json();case 3:(n=e.sent).profile=n.profile+"#"+(new Date).getTime(),console.log(n),localStorage.setItem("email",n.email),200===t.status?a.setState({email:n.email,isSignUp:!Z(n),driver:n,isLoading:!1}):(console.log("This email is not associated with this access token"),a.handleError("You are not signed in. Please sign in to visit this page."));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleImageUploadError=function(e,t){console.log("There was an error uploading image:",e);return a.setNotification(!0,"There was an error uploading your image",t,!0),!1},a.handleFormSubmission=function(){var e=Object(f.a)(p.a.mark(function e(t,n,r){var i,o,s,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Object(d.a)({},t)).email=a.state.email,console.log("driver on form submission:",i),o=[],!a.state.isSignUp||Z(i)){e.next=10;break}return console.log("missing field(s):",i),a.alertInvalidInput("Please fill out all required fields to sign up"),e.abrupt("return",!1);case 10:console.log("all require fields filled"),_.concat(I).forEach(function(e){if("email"!==e&&"string"===typeof i[e]){var t=a.validateEdit(i[e],e);t.isValid?(console.log("valid value:",t),i[e]=t.isValid):o.push(e)}});case 12:if(0!==(s=o.map(function(e){var t;return t=_.includes(e)?e:i[e]?e:void 0,a.state.driver[e]&&(i[e]=a.state.driver[e]),t}).filter(function(e){return e})).length){e.next=18;break}return a.setState({driver:i},function(){a.refreshDriverInfo(i,n,r)}),e.abrupt("return",!0);case 18:return c=s.map(function(e){return" - "+Y[e]}),a.setModal(!0,"Invalid Edits:",c),e.abrupt("return",!1);case 21:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.refreshDriverInfo=function(){var e=Object(f.a)(p.a.mark(function e(t,n,r){var i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("pics:",n.length),!a.state.isSignUp){e.next=8;break}return t.profile=t.profile+"#"+Date.now(),e.next=5,ne(t,a.handleCreateResponse,r,console.log);case 5:a.setState({isSignUp:!1}),e.next=10;break;case 8:i=n[n.length-1],re(t,i,a.handleUpdateResponse,a.notifyError);case 10:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.alertInvalidInput=function(e){a.setState({isLoading:!1},function(){a.setNotification(!0,"Invalid form submission:",e,!0)})},a.validateEdit=function(e,t){var a={isValid:!1,field:t};return a.isValid=G(t,e),a},a.handleCreateResponse=function(){var e=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,console.log("server response:",n),200===t.status?a.setNotification(!0,"Success!","Your Account Was Created!",!1):a.setState({error:n.msg,isLoading:!1});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleUpdateResponse=function(){var e=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,console.log("update response:",t),200===t.status?a.setNotification(!0,"Success","Your changes have been saved!",!1):400===t.status?(a.setNotification(!0,"Error","There was an error with authenticating your account",!0),a.setState({isLoading:!1})):403===t.status?a.setState({error:"This access token doesn't allow modification to this user",isLoading:!1}):a.setState({error:"Error: "+JSON.stringify(n),isLoading:!1});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.render=function(){var e={email:a.state.email,driver:a.state.driver,handleFormSubmission:a.handleFormSubmission,setModal:a.setModal,setNotification:a.setNotification,isSignUp:a.state.isSignUp,askForPassword:!1,askForEmail:!1,redirectToOrigin:a.redirectToOrigin,logoutDriver:a.logoutDriver};return console.log(a.state.isSignUp),a.state.error?i.a.createElement($,{err:a.state.error}):a.state.isLoading?i.a.createElement(j,null):i.a.createElement(i.a.Fragment,null,i.a.createElement(K,e),a.createModal(),a.createNotification())},a.state={isSignUp:!1,email:void 0,driverUpdate:void 0,driver:void 0,isLoading:!0,error:void 0,isEditing:!1,picture:[],modal:{},notification:{}},te(a.receiveDriver,a.handleError),a}return Object(E.a)(t,e),t}(r.Component),oe=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(v.a)(this,Object(h.a)(t).call(this,e))).render=function(){return i.a.createElement("div",null,i.a.createElement(q,{title:a.state.title}),i.a.createElement("h2",null,"This page is not ready yet"))},a.state={ready:!1,title:"About"},a}return Object(E.a)(t,e),t}(r.Component),se=a(79),ce=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(v.a)(this,Object(h.a)(t).call(this,e))).render=function(){return a.state.isLoading?i.a.createElement(j,null):i.a.createElement("div",null,i.a.createElement(q,{title:a.state.title}),i.a.createElement("div",{className:"lb-form-content"},"Select week:",i.a.createElement("select",{value:a.state.value,onChange:function(e){return a.handleChange(e)}},a.createOptions()),i.a.createElement("p",null,a.daysLeft()," day(s) left for this week competition")),i.a.createElement("div",{className:"tableContainer"},a.createRow("#","Email Addresses","# of Events",!0),a.state.drivers.map(function(e,t){return a.createRow(t+1,e.email,e.count)})))},a.state={title:"Leader Board",apiUrl:"https://mixpanel.com/api/2.0/events/properties?",param:"type=general&name=driver&event=Touch Me&",isLoading:!0,currentDriver:localStorage.getItem("email"),drivers:[],value:""},a.getAllDrivers(a.state.value),a}return Object(E.a)(t,e),Object(se.a)(t,[{key:"getAllDrivers",value:function(){for(var e=this,t=this.state.apiUrl,a=this.state.param,n="",r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];n=i[0].length>0?"lifetimeCount"===i[0]?"unit=year&interval=10":"unit=day&interval=6&from_date="+i[0]:"unit=week",fetch(t+a+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Basic NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}}).then(function(e){return e.json()}).then(function(t){var a=t.data.values,n=[],r=0;Object.keys(a).forEach(function(e){Object.keys(a[e]).forEach(function(t){r+=a[e][t]}),n.push({email:e,count:r}),r=0}),n.sort(e.sortByProperty("count")),e.setState({drivers:n}),e.setState({isLoading:!1})})}},{key:"sortByProperty",value:function(e){return function(t,a){return a[e]-t[e]}}},{key:"emailMasking",value:function(e){return e.indexOf("@")>0?e.substring(0,1)+"***"+e.substring(e.indexOf("@")-1):e}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:t}),this.setState({isLoading:!0}),this.getAllDrivers(t)}},{key:"findLastMonday",value:function(){var e=new Date;return e.setDate(e.getDate()-(e.getDay()+6)%7),e}},{key:"formatDate",value:function(e){var t=e,a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("-")}},{key:"createOptions",value:function(){for(var e=this.findLastMonday(),t=e.toISOString().slice(0,10),a=[i.a.createElement("option",{value:t,key:1},"Current week")],n=0;n<10;n++)e.setDate(e.getDate()-7),t=this.formatDate(e),a.push(i.a.createElement("option",{value:t,key:n+2},t));return a.push(i.a.createElement("option",{value:"lifetimeCount",key:12},"Lifetime count")),a}},{key:"daysLeft",value:function(){return 7-((new Date).getDay()+6)%7}},{key:"createRow",value:function(e,t,a,n){return i.a.createElement("div",{className:"tableRow",style:{backgroundColor:this.state.currentDriver===t?"rgba(180, 197, 249)":"",fontWeight:n?"bold":""}},i.a.createElement("div",{className:"rowContent columnOne"},e),i.a.createElement("hr",null),i.a.createElement("div",{className:"rowContent columnTwo"},this.emailMasking(t)),i.a.createElement("hr",null),i.a.createElement("div",{className:"rowContent columnThree"},a))}}]),t}(r.Component),le=(a(190),function(){var e=u.a.parse(window.location.search);return console.log(e),e.ref&&(console.log("ref:",e.ref),window.location.href=n+"/auth0login/driverprofile/?ref=".concat(e.ref)),i.a.createElement("div",null,i.a.createElement(c.d,null,i.a.createElement(c.b,{exact:!0,path:"/profile",component:ie}),i.a.createElement(c.b,{exact:!0,path:"/error",component:$}),i.a.createElement(c.b,{exact:!0,path:"/about",component:oe}),i.a.createElement(c.b,{exact:!0,path:"/leaderboard",component:ce}),i.a.createElement(c.b,{component:function(){return i.a.createElement(c.a,{exact:!0,to:"/profile"+window.location.search})}})))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=a(36),de=a(82),me=a.n(de),pe="production"===Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV;console.log("process.env.REACT_APP_ENV: ",Object({NODE_ENV:"production",PUBLIC_URL:"/driver-profile",REACT_APP_MIXPANEL_BASIC_AUTH_KEY:"NjZkODBmYWRlYzJlZjM5NjU3ZGM1M2UwZGQ3YTc4ZDA6"}).REACT_APP_ENV),pe?(k.a.initialize("UA-129510306-1",{debug:!1,siteSpeedSampleRate:100}),s.a.render(i.a.createElement(ue.a,null,i.a.createElement(me.a,{org:"GKC8F"}),i.a.createElement(le,null)),document.getElementById("root"))):s.a.render(i.a.createElement(ue.a,null,i.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},85:function(e,t,a){e.exports=a(193)},90:function(e,t,a){}},[[85,1,2]]]);
//# sourceMappingURL=main.1fc4832d.chunk.js.map